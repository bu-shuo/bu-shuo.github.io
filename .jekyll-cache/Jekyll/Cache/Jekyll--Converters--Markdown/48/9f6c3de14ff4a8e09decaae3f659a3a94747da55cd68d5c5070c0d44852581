I"<p><br /></p>

<h1 id="0x00-介绍">0x00 介绍</h1>
<hr />

<p>大量的日志经常被用于离线分析或实时监控，以调试系统故障或识别威胁。目前的研究主要有从审计日志构建因果关系图，并使用查询系统定位关键攻击阶段；有对机器学习技术进行扩展，从日志中自动提取特征或序列来检测故障和入侵；还有通过事件相关性构建技术，发现不同日志事件之间的联系。但这些工作很大程度上无法精准定位端到端的攻击过程。</p>

<p>本文提出的 ATLAS 主要是从审计日志中识别关键节点，然后协助安全分析师构建攻击过程。ATLAS 将自然语言处理（NLP）和深度学习集成到数据分析中，用来识别攻击和非攻击序列。这种基于序列的表示方法很好地适应了模型的训练，使模型具有更深层次的因果关系记忆，从而提高了序列模型识别未知审计日志攻击步骤的准确性。然而，这种方法面临如下的挑战：</p>

<ol>
  <li>因果关系图大而复杂，使序列构建困难</li>
  <li>需要一种方法精确构建序列，有效地对良性和恶意活动建模</li>
  <li>需要一种自动化的方法识别攻击事件</li>
</ol>

<p>ATLAS 使用了定制的图优化算法降低图的复杂性，实现从日志事件中提取攻击模式序列，并通过攻击症状进行攻击调查，以恢复攻击事件，帮助全面构建攻击过程。</p>

<h1 id="0x01-贡献">0x01 贡献</h1>
<hr />

<ol>
  <li>本文设计的 ATLAS 是一种用于攻击过程还原的框架，利用自然语言处理和基于序列的模型，帮助网络分析师从审计日志中恢复攻击过程。</li>
  <li>提出一种新的序列表示方法，通过词形还原（Lemmatization）和词嵌入（Word Embeddings）来抽象攻击和非攻击语义模式。</li>
  <li>验证了 ATLAS 在 10 个真实 APT 攻击中的效果，结果表明，ATLAS 能够以较高的准确性和最小的开销识别攻击事件的关键攻击条目。</li>
</ol>

<h1 id="0x02-背景">0x02 背景</h1>
<hr />

<p>大多数的研究从因果关系图中将攻击过程恢复为子图以展开攻击调查，如下图中 a 所示，红色虚线框中表示的是恢复的攻击子图，图中 b 是 APT 攻击步骤的描述，图 c 则是 ATLAS 恢复的攻击过程。</p>

<p><img src="https://bu-shuo.github.io/image/2021-08-15-01.png" alt="恢复攻击图" /></p>

<ol>
  <li>在恢复攻击子图的过程中虽然采用了不同的图优化技术，但由于很大程度上依赖启发式或硬编码规则，开发和维护这些规则非常耗时，需要专家并不断更新规则库，ATLAS 只需要更多的攻击训练数据来学习新的攻击模式。</li>
  <li>虽然基于异常的方法可以识别未知的攻击，但随着用户行为的变化可能会产生大量误报。为了解决这个问题， ATLAS 旨在区分攻击行为和用户行为。</li>
  <li>与 ATLAS 类似基于深度学习的算法从日志中建模攻击事件，虽然减少了日志数量，但仍需要大量的人工工作来查找攻击事件的高级视图。而 ATLAS 旨在识别攻击的关键节点，然后自动识别相关攻击事件的子集。</li>
</ol>

<p>定义：（如下图所示）</p>

<p><img src="https://bu-shuo.github.io/image/2021-08-15-02.png" alt="定义图示" /></p>

<p><strong>因果关系图（Causal Graph）：</strong> 因果关系图是从审计日志中提取的数据结构，常用于源头跟踪，表示主体与对象之间的因果关系。</p>

<p><strong>邻域图（Neighborhood Graph）：</strong> 给定一个因果关系图，如果两个节点由一条边连接，则称它们是邻居。所以对于给定节点，邻域图包括该节点和邻居节点，并且包含邻居节点的所有边。</p>

<p><strong>事件（Event）：</strong> 一个事件由一个四元组（src，action，dest，t）组成，源（src）和目的（dest）是与一个动作（action）相连的两个实体，而 t 则表示事件发生的时间。</p>

<p><strong>序列（Sequence）：</strong> 给定实体 e，可以从因果关系中提取包含实体 e 邻域图的所有事件。</p>

:ET